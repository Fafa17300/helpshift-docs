---
sidebar_position: 150
title: トラブルシューティング
description: SDKに関するよくある問題と、その解決策について詳しく説明します。
---

import {
  Admonition,
  CodeBlock,
  Tabs,
  TabItem,
  LatestSdkVersion,
  Centered,
  Image,
  Intro,
  SideBySide,
  DownloadButton,
  Steps,
  Step,
} from "@site/src/components/forDocs";

# トラブルシューティング {#troubleshoot}

## デバッグログの共有 {#share-debug-logs}

v10.2.0 では、Helpshift SDK はアプリがデバッグモードで実行されている場合にメールを介して内部ログを共有することができます。
これにより、デバイスから直接ログを送信することでより速くログを収集できるようになります。

SDK のデバッグログの共有は、以下の手順で行うことができます。

- 以下の条件を満たした場合に、デバイスの通知バーに通知を送信します。

  1.  アプリケーションがデバッグモードでビルドされている場合。
  2.  `enableLogging`フラグが`true`に設定されている場合。構成については、[こちら](/sdkx_android/sdk-configuration#enable-logging)をご参照ください。

- 通知のタイトルは`Helpshift Debugger`です。
- SDK は、初期化が完了するとすぐにこの通知を送信します。初期化の手順については、[こちら](/sdkx_android/getting-started#initializing)をご参照ください。
- SDK で直面している問題を再現します。
- この通知をクリックすると、ログを共有するためのアプリの選択メニューが開きます。
- 特定のアプリの中からメールアプリを選択します。
- メールアプリでは、デフォルトで`bugs@helpshift.com`が受信者として設定されています。
- 内容を変更せずに、メールを送信します。
- 問題がアプリのクラッシュに関連している場合には、以下の手順に従ってください。
  1.  アプリをもう一度起動します。
  2.  通知バーに同じ通知が再度表示されるはずです。
  3.  通知をクリックして、ログを共有します。

<Admonition type="info" title="注意">

アプリがリリース/本番モードの場合、ログの収集や保存は実行されません。

</Admonition>

## SDK の統合 {#integration-issues}

### AndroidX（バージョン 10.3.0 以上）に移行しました

Helpshift SDK X は、`10.3.0`から AndroidX へと完全に移行しました。クライアントアプリがレガシーライブラリを使用している場合、SDK X はコンパイルを実行しません。

### AndroidX サポートライブラリの使用（バージョン 10.2.X 以下） {#steps-to-build-with-android-x}

Helpshift SDK X では、レガシー版の Android サポートライブラリを使用しています。アプリケーションで AndroidX ライブラリを使用する場合には、以下の手順に従って Helpshift SDK と AndroidX の互換性を確保してください。

1. プロジェクトの targetSdkVersion を 28 以上に設定します。
2. gradle.properties ファイルに以下の行を追加します。

```groovy
android.useAndroidX=true
android.enableJetifier=true
```

Jetifier は、サポートライブラリに依存するライブラリを同等の AndroidX パッケージに依存するように移行するためのツールです。

[こちら](https://developer.android.com/studio/command-line/jetifier)で言及されているスタンドアロンの Jetifier ツールを使用する場合には、以下の手順に従ってください。

Jetifier をインストールするには、[この zip ファイルをダウンロード](https://dl.google.com/dl/android/studio/jetifier-zips/1.0.0-beta10/jetifier-standalone.zip)し、解凍します。
ご利用のデバイスに**Java のバージョン 1.8 がインストールされている**必要があります。

ライブラリを処理するには、現在のライブラリへのパスと、ツールで作成した出力ファイルへのパスを渡します

例:

`./jetifier-standalone -i <source-library> -o <output-library>`

## 既知の問題 {#known-issues}

### 無効な言語コードによる CORS エラー {#cors-error}

チャット画面を読み込むことができず、コンソールや Android の Logcat でこのエラーが表示される場合には、

```
Access to XMLHttpRequest at 'https://api.helpshift.com/websdk/……' from origin
'https://…...webchat.helpshift.com' has been blocked by CORS policy: Request
header field accept-language is not allowed by Access-Control-Allow-Headers in
preflight response. -- From line 0 of https://……...webchat.helpshift.com/latest/
android/html/index.html?v=3.32.1&parent=https%3A%2F%2Flocalhost
```

これは Helpshift SDK に渡された無効な言語コードが原因となっている可能性があります。この問題を解決するには、`Helpshift.setLanguage(String language)` API を使用して有効な言語コードを Helpshift SDK に渡します。
有効な言語コードの値に含めることができる文字は、`0-9, A-Z, a-z, space or *,-.;=.`のみです。

詳細については、[こちら](/sdkx_android/i18n/#supported-languages)をご参照ください。

### プッシュ通知を取得できない {#push-notification-issue}

Helpshift からプッシュ通知を取得できない場合には、[通知](/sdkx_android/notifications#push-via-helpshift)に記載されている開発者向けドキュメントの内容に即した適切な手順に従っているかどうかをご確認ください。

それでも通知を取得できない場合には、以下をご確認ください。

- Firebase コンソールから Cloud Messaging API（レガシー）を有効にし、[通知](/sdkx_android/notifications#push-via-helpshift)に記載されているように、ダッシュボードでサーバーキーを入力してください。

<Image src="/static/books/helpshiftx/gcm-key-example.png" width="full" />{" "}

### 通知バーに通知が表示されない

Android 13 では、アプリが通知を送信できるようにエンドユーザーが許可を与える必要があります。

お客様のアプリが Android 13（API レベル 33）をターゲットにしている場合、これが通知が機能しない原因になっている可能性があります。

アプリが通知を送信できるようにするには、通知の許可を要求する必要があります。詳細については、[Android ドキュメンテーション](https://developer.android.com/develop/ui/views/notifications/notification-permission)をご参照ください。

Helpshift SDK が通知の許可を要求することはありません。これに関しては、アプリケーションに依存しています。

## その他

### デバイスのブラウザーがサポートしていない添付ファイルの処理

- ユーザーが会話の中で添付ファイルをクリックすると、SDK はデフォルトでブラウザーで添付ファイルを開こうとします。これは、CDN の URL から直接開こうとすることが原因です。
- ブラウザーがファイルを開けない場合には、デバイス上のファイルをダウンロードします。
- ユーザーがダウンロードしたファイルを開こうとする際にファイルをアプリで開くオプションを提供することにより、そういったファイルを開いたり消費したりする処理をアプリに追加することができます。
- ユーザーによるシステム全体でのファイルを開く操作の処理については、[こちら](https://developer.android.com/guide/components/intents-filters)のインテントフィルターを参照してください。
