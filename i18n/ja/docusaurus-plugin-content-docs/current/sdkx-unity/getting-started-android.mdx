---
sidebar_position: 150
title: はじめに（Androidの場合）
description: "Unityゲームに素晴らしいアプリ内サポートを追加するには、3つのステップが必要となります。"
---

import {
  Admonition,
  CodeBlock,
  Tabs,
  TabItem,
  LatestSdkVersion,
  Centered,
  Image,
  Intro,
  SideBySide,
  DownloadButton,
  Steps,
  Step,
} from "@site/src/components/forDocs";

# はじめに<small>（Android の場合）</small> {#getting-started}

<Intro>

Unity ゲームに素晴らしいアプリ内サポートを追加するには、3 つのステップが必要となります。

</Intro>

C#や JavaScript で記述されたゲームスクリプトから呼び出し可能な Helpshift SDK X 用の Unity プラグインの統合方法について説明します。

## 要件 {#version-requirements}

- Unity5.5.6 以上。

- SDK X は、API レベル 24 以上（Android OS 7 Nougat 以上）でのみ動作します。

- コード内の`minSDKVersion`は、API レベル 16（Android 4.4 Jelly Bean）までをインストール可能なアプリで SDK をインポートしてコンパイルできるようにするために、API レベル 16 として保持されています。

- あなたのアプリが API レベル 24 以下（Android OS 7 Nougat 以下）のデバイスにインストールされている場合、サポートの提供に別のメディアを選択することができます。たとえば、電子メールやウェブサイトなどです。

<Admonition type="info" title="注意">

- アップデート（2023 年 8 月）: SDK X 10.2.X は、API レベル 24 以上（Android OS 7 Nougat 以上）でのみ動作します。
- SDK X 10.3.0 は、Android 7 以上（API レベル 24 以上）でサポートされています。最低限の API レベルであるレベル 16 でコンパイルすることは可能ですが、サポート対象は API レベル 24 以上です。
  詳細については、[こちらの記事](https://support.helpshift.com/hc/en/13-helpshift-technical-support/faq/1217-sdk-x-os-technical-support-policy/)を参照してください。
- Helpshift SDK X は Android 14 をサポートしていますが、現在 Unity はこのバージョンを公式にサポートしていません。Unity を使用している場合、SDK X を Android 14 と統合する際に互換性に関連する問題が発生する可能性があります。

</Admonition>

## Helpshift Unity SDK のダウンロード {#getting-sdk}

#### 1. SDK X - アプリ内カスタマーサービス {#standard-sdk}

<DownloadButton
  text="Download SDK"
  link="[% sdkx-unity.android.sdk_url %]"
  classes="mb-4"
/>

Helpshift SDK *.zip*フォルダーには、以下のものが含まれています。

<div className="text-sm compact ">

|                                              |                                                                          |
| -------------------------------------------- | ------------------------------------------------------------------------ |
| helpshiftX-plugin-unity-v10.3.0.unitypackage | Helpshift SDK X の Unity パッケージ                                      |
| unity-jar-resolver (v1.2.170.0)              | Android Helpshift パッケージのサポートライブラリの依存関係を解決します。 |

</div>

## Unity プロジェクトに Helpshift を追加する {#adding-to-project}

- Helpshift Unity SDK パッケージを解凍します。
- Helpshift Unity SDK は、Unity パッケージのインポート手順を介してインポート可能な標準の`.unitypackage`として表示されます。
- `helpshiftx-plugin-unity-version.unitypackage`を Unity ゲームにインポートする手順は、以下の通りです。
  1. 「Unity プロジェクトを開く」でドロップダウンメニュー「**アセット**」に移動し、「**パッケージをインポート**」、「**カスタムパッケージ**」の順に選択する
  2. 解凍した SDK から`helpshiftx-plugin-unity-version.unitypackage`ファイルを選択し、Helpshift SDK をインポートする。
  3. 「Unity パッケージのインポート」ウィンドウで、「**インポート**」をクリックする
  4. iOS 用としても統合する場合には、unitypackage のインポート中に`iOS/Helpshift.framework`フォルダーを選択する。[こちら](/sdkx-unity/getting-started-ios#adding-to-project)をご参照ください。

## Android AppCompat ライブラリの要件を解決する {#resolve-android-appcompat-library-requirements}

Helpshift SDK は、Android AppCompat ライブラリに依存しています。これらのライブラリは、使用するビルド方法に応じて以下のいずれかの方法で入手できます。

### Unity 内部のビルドシステムまたは Unity 内部の Gradle ビルドシステムを使用する際に依存関係を解決する {#resolve-dependency-via-jar-resolver}

Android ライブラリの依存関係をダウンロードして統合するには、**Unity Jar Resolver**プラグインを使用します。

<Admonition type="info" title="注意">

すでにプロジェクトで*Unity Jar Resolver*を使用している場合には、*Unity Jar Resolver*のインポート手順を省略できます。

*Unity Jar Resolver*については、必要に応じてすべてのバージョンをご利用いただけます。Helpshift では、開発者にとって使いやすいようにこれをパッケージ化しています。

*Unity Jar Resolver*のリリースについては、こちらでご確認ください。https://github.com/googlesamples/Unity Jar Resolver/tags

</Admonition>

- **Unity Jar Resolver**プラグインを Unity プロジェクトにインポートする

  1. 「Unity プロジェクトを開く」でドロップダウンメニュー「**アセット**」に移動し、「**パッケージをインポート**」、「**カスタムパッケージ**」の順に選択します
  2. 解凍した Helpshift SDK から`unity-jar-resolver/external-dependency-manager-1.2.170.unitypackage`ファイルを選択して Unity Jar Resolver をインポートします。
  3. 「Unity パッケージのインポート」ウィンドウで、「**インポート**」をクリックします

- Unity Jar Resolver が Android の自動解決の有効化を要求している場合には、「有効にする」ボタンをクリックし、依存関係ファイルの変更時にすべての依存関係が自動的に解決されるようにします。この設定の有効/無効を切り替えるには、「アセット」、「PlayServicesResolver」、「Android Resolver」の順に移動し、「設定」を使用してください。
- デフォルトでは、Unity Jar Resolver は必要な依存関係をすべて自動で解決します。依存関係を手動で解決する手順は、以下の通りです。
  1. 「Unity プロジェクトを開く」でドロップダウンメニュー「**アセット**」に移動し、「**PlayServicesResolver**」、「**Android Resolve**」の順に選択します
  2. 「**Resolve**」または「**Force Resolve**」を選択します
- Unity Jar Resolver の詳細については、「[Unity Jar Resolver](https://github.com/googlesamples/unity-jar-resolver)」をご参照ください

### カスタム Gradle テンプレートまたはエクスポートプロジェクトを使用する際の依存関係を解決する {#resolve-dependency-via-gradle}

*Unity の組み込み Gradle ビルドサポート*  と*Android Studio へのエクスポート*  はプラグイン単位の Gradle スクリプトをサポートしていません。したがって、Helpshift SDK はデフォルトの状態ではそれ自体で依存関係を追加することができません。

「プレイヤー」ウィンドウで**カスタム Gradle テンプレート**プロパティを有効にすると、`mainTemplate.gradle`が生成されます。

「プレイヤー」ウィンドウで**Export Project**プロパティを有効にした状態でプロジェクトをビルドすると、生成された Gradle プロジェクトに`build.gradle`が存在しています。

`mainTemplate.gradle`または`build.gradle`ファイルの**依存関係**セクションを、以下のように更新します。

<Tabs groupId="android-dependencies-example">

<TabItem value=">= 10.3.0" label="10.3.X">

```groovy
    dependencies {
        implementation fileTree(dir: 'libs', include: ['*.jar'])
        implementation(name: 'Helpshift', ext:'aar')
        implementation 'androidx.appcompat:appcompat:1.0.0'
    }
```

</TabItem>
<TabItem value="<= 10.2.X>" label="Below 10.2.3">

```groovy
    dependencies {
        implementation fileTree(dir: 'libs', include: ['*.jar'])
        implementation(name: 'Helpshift', ext:'aar')
        implementation 'com.android.support:appcompat-v7:28.0.0'
    }
```

</TabItem>
</Tabs>

Unity の Gradle テンプレートについてのドキュメントは、「https://docs.unity3d.com/Manual/gradle-templates.html」を参照してください。

## アプリで Helpshift を初期化する {#initializing}

Helpshift の API を使用するには、以下のように Helpshift の名前空間をインポートしてください

```csharp
using Helpshift;
```

1. 最初に、Helpshift ダッシュボードでアプリを作成します

   <Image src="/static/books/helpshiftx/add_app.png" width="full" />{" "}

2. 選択した`Platform`に**Android**を指定してアプリを作成します

   <Image
     src="/static/books/helpshiftx/create_app_with_android_platform.png"
     width="full"
   />{" "}

Helpshift は、登録済みの各種アプリを以下の 2 つのトークンの組み合わせによって一意に識別します。

<div className=" compact">

|                          |                                                            |
| ------------------------ | ---------------------------------------------------------- |
| <code>Domain Name</code> | あなたの Helpshift ドメイン。例: _happyapps.helpshift.com_ |
| <code>Platform ID</code> | あなたのアプリ固有のアプリ ID                              |

</div>
これらは、エージェントダッシュボードで`Settings`、`SDK (for Developers)`の順に移動して見つけることができます。
ドロップダウンで対象のアプリと_check Android as a platform_を選択し、
Helpshiftを初期化する際に渡される2つのトークンをコピーします。
<Image src="/static/books/helpshiftx/copy_install_keys.png"  width="full" />

メソッド\_install(appId, domain)\_API を呼び出し、Helpshift を初期化します

```csharp
using Helpshift;

public class MyGameControl : MonoBehaviour
{
    private HelpshiftSdk help;
    ...
    void Awake() {
        help = HelpshiftSdk.GetInstance();
        var configMap = new Dictionary<string, object>();
        help.Install(appId, domainName, configMap);
    }
    ...
}
```

#### 中国向けのアプリで Helpshift を初期化する {#chinasupport}

中国リージョン向けに Helphift SDK を統合するには、特別なインストール設定キーである`isForChina`を使用する必要があります。
この設定キーはブール値を受け入れます。中国リージョン向けのアプリで SDK を統合する場合には、`true`を渡してください。指定がない場合のデフォルト値は、`false`です。

```csharp
using Helpshift;

public class MyGameControl : MonoBehaviour
{
    private HelpshiftSdk help;
    ...
    void Awake() {
        help = HelpshiftSdk.GetInstance();
        var configMap = new Dictionary<string, object>();
        configMap.Add("isForChina", true);
        help.Install(appId, domainName, configMap);
    }
    ...
}
```

<Admonition type="danger" title="重要">

**インストール呼び出しの配置**

インストール呼び出しは、必ず`Awake()`メソッド内に配置してください。これを他の場所に配置すると、実行時の予期せぬ問題が引き起こされてしまう可能性があります。

**HelpshiftInitializationException**

インストール呼び出しよりも先に API を呼び出すと、デバッグモードで非チェックの HelpshiftInitializationException がスローされる可能性があります。

_Android OS version Support_

バージョン 24 未満の Android SDK で`install()`を呼び出しても動作しません。すべての API が操作不可能となります。

</Admonition>

## Helpshift の使用を開始する {#start-using}

これで Helpshift がアプリに統合されました。今後はアプリ内で[会話画面](/sdkx-unity/support-tools-android#conversation-view)用のサポート API を使用する必要があります。

アプリを実行し、\_ShowConversation_API 呼び出しを使用してテスト会話を開始してみてください。
その後は Helpshift エージェントダッシュボードへと移動し、返信を行ってアプリ内のメッセージングを体験してみてください。

FAQ と会話 API の使用例は、以下の通りです。

```csharp
public class MyGameControl : MonoBehaviour
{
    private HelpshiftSdk help;

    void Awake(){
        // install call here
    }

    void OnGUI () {
        ...
        var configMap = new Dictionary<string, object>();
        // Starting a conversation with your customers
        if (MenuButton (contactButton))
        {
            help.ShowConversation(configMap);
        }
    }
}
```

<Admonition type="info" title="注意">
  Helpshiftプラグインはモバイルデバイスでの使用のみを想定しているため、Helpshiftの呼び出しはすべてチェックの中に入れ
  、デバイス上での動作時にのみ 呼び出されるようにしてください。
</Admonition>
